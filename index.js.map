{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\r\nimport axios from 'axios';\r\n\r\nconst API_KEY = 'ВАШ_PIXABAY_API_KEY'; \r\nconst BASE_URL = 'https://pixabay.com/api/';\r\nconst PER_PAGE = 15; \r\n\r\nexport async function getImagesByQuery(query, page = 1) {\r\n  const url = `${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${PER_PAGE}`;\r\n\r\n  try {\r\n    const response = await axios.get(url);\r\n    return response.data; \r\n  } catch (error) {\r\n    console.error('Ошибка при запросе к Pixabay:', error);\r\n    throw error;\r\n  }\r\n}\r\n","// src/js/render-functions.js\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nconst galleryContainer = document.querySelector('.gallery');\r\nconst loadMoreBtn = document.querySelector('.js-load-more');\r\nconst loaderEl = document.querySelector('.js-loader');\r\n\r\n\r\nconst lightbox = new SimpleLightbox('.gallery a', {\r\n  captionsData: 'alt',\r\n  captionPosition: 'bottom',\r\n  captionDelay: 250\r\n});\r\n\r\n  @param {Array} images \r\n \r\nexport function createGallery(images) {\r\n  const markup = images\r\n    .map(\r\n      ({\r\n        webformatURL,\r\n        largeImageURL,\r\n        tags,\r\n        likes,\r\n        views,\r\n        comments,\r\n        downloads\r\n      }) => `\r\n    <li class=\"gallery-item\">\r\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\r\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\r\n      </a>\r\n      <div class=\"info\">\r\n        <p><b>Likes:</b> ${likes}</p>\r\n        <p><b>Views:</b> ${views}</p>\r\n        <p><b>Comments:</b> ${comments}</p>\r\n        <p><b>Downloads:</b> ${downloads}</p>\r\n      </div>\r\n    </li>\r\n  `\r\n    )\r\n    .join('');\r\n\r\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\r\n  lightbox.refresh(); \r\n}\r\n\r\nexport function clearGallery() {\r\n  galleryContainer.innerHTML = '';\r\n}\r\n\r\nexport function showLoader() {\r\n  loaderEl.hidden = false;\r\n}\r\n\r\nexport function hideLoader() {\r\n  loaderEl.hidden = true;\r\n}\r\n\r\nexport function showLoadMoreButton() {\r\n  loadMoreBtn.hidden = false;\r\n}\r\n\r\nexport function hideLoadMoreButton() {\r\n  loadMoreBtn.hidden = true;\r\n}\r\n","// src/js/main.js\r\nimport { getImagesByQuery } from './js/pixabay-api.js';\r\nimport {\r\n  createGallery,\r\n  clearGallery,\r\n  showLoader,\r\n  hideLoader,\r\n  showLoadMoreButton,\r\n  hideLoadMoreButton\r\n} from './js/render-functions.js';\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nconst formEl = document.querySelector('.form');\r\nconst loadMoreBtn = document.querySelector('.js-load-more');\r\n\r\nlet currentQuery = '';\r\nlet currentPage = 1;\r\nlet totalHits = 0;\r\n\r\nformEl.addEventListener('submit', onSearch);\r\nloadMoreBtn.addEventListener('click', onLoadMore);\r\n\r\nasync function onSearch(event) {\r\n  event.preventDefault();\r\n\r\n  const formData = new FormData(formEl);\r\n  const query = formData.get('search-text').trim();\r\n\r\n  if (query === '') {\r\n    iziToast.error({ message: 'Please enter a search query', position: 'topRight' });\r\n    return;\r\n  }\r\n\r\n  currentQuery = query;\r\n  currentPage = 1;\r\n  totalHits = 0;\r\n  clearGallery();\r\n  hideLoadMoreButton();\r\n\r\n  try {\r\n    showLoader();\r\n    const data = await getImagesByQuery(currentQuery, currentPage);\r\n\r\n    if (data.hits.length === 0) {\r\n      iziToast.info({\r\n        message: 'Sorry, there are no images matching your search query. Please try again!',\r\n        position: 'topRight'\r\n      });\r\n      return;\r\n    }\r\n\r\n    totalHits = data.totalHits;\r\n    createGallery(data.hits);\r\n\r\n    if (data.totalHits > 15) {\r\n      showLoadMoreButton();\r\n    } else {\r\n      hideLoadMoreButton();\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n    iziToast.error({ message: 'Something went wrong. Please try again later.', position: 'topRight' });\r\n  } finally {\r\n    hideLoader();\r\n  }\r\n}\r\n\r\nasync function onLoadMore() {\r\n  currentPage += 1;\r\n\r\n  if ((currentPage - 1) * 15 >= totalHits) {\r\n    hideLoadMoreButton();\r\n    iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\", position: 'topRight' });\r\n    return;\r\n  }\r\n\r\n  try {\r\n    showLoader();\r\n    const data = await getImagesByQuery(currentQuery, currentPage);\r\n    createGallery(data.hits);\r\n\r\n    const firstCardHeight = document\r\n      .querySelector('.gallery .gallery-item')\r\n      .getBoundingClientRect().height;\r\n\r\n    window.scrollBy({\r\n      top: firstCardHeight * 2,\r\n      behavior: 'smooth'\r\n    });\r\n\r\n    if (currentPage * 15 >= totalHits) {\r\n      hideLoadMoreButton();\r\n      iziToast.info({ message: \"We're sorry, but you've reached the end of search results.\", position: 'topRight' });\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n    iziToast.error({ message: 'Error loading more images. Please try again.', position: 'topRight' });\r\n  } finally {\r\n    hideLoader();\r\n  }\r\n}\r\n"],"names":["API_KEY","BASE_URL","PER_PAGE","getImagesByQuery","query","page","url","axios","error","galleryContainer","loadMoreBtn","loaderEl","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","formEl","currentQuery","currentPage","totalHits","onSearch","onLoadMore","event","iziToast","data","firstCardHeight"],"mappings":"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"}